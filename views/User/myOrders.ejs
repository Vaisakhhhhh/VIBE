<div>
    <div class="z-50 fixed w-full">
        <!-- Include header partials -->
        <%- include("partials/header") %>
    </div>

    <div class="pt-20">

        

        <div class="w-full px-36">

            
            <div class="container mx-auto p-4">

                <nav class="flex ml-2 mb-2" aria-label="Breadcrumb">
                    <ol class="inline-flex items-center space-x-1 md:space-x-1 rtl:space-x-reverse">
                        <li class="inline-flex items-center">
                            <a href="/" class="inline-flex items-center text-xs font-medium text-gray-700 hover:text-blue-500 dark:text-gray-400">
                                Home
                            </a>
                        </li>
                        <li>
                            <div class="flex items-center">
                                <svg class="rtl:rotate-180 w-2 h-2 text-gray-400 mx-1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4" />
                                </svg>
                                <a href="/user/profile" class="inline-flex items-center text-xs font-medium text-gray-700 hover:text-blue-500 dark:text-gray-400">
                                    My Account
                                </a>
                            </div>
                        </li>
                        <li aria-current="page">
                            <div class="flex items-center">
                                <svg class="rtl:rotate-180 w-2 h-2 text-gray-400 mx-1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4" />
                                </svg>
                                <span class="ms-1 text-xs font-medium text-gray-500 md:ms-2 dark:text-gray-400">My Orders</span>
                            </div>
                        </li>
                    </ol>
                </nav>

                <% if (myOrders.length > 0) { %> 

                    <% myOrders.forEach(order => { %> 

                    
                        <div class="bg-white shadow-md rounded-lg px-6 pt-6 mb-4 border hover:shadow-lg ">
                            <!-- Order Header -->
                            <div class="flex justify-between items-center mb-4">
                                <div>
                                    <h3 class="text-lg font-semibold">Order ID: <%= order._id %></h3>
                                    <p class="text-gray-600 text-sm">Date: <%= order.formattedDate %></p>
                                </div>
                                <div class="text-right">
                                    <p class="text-gray-700 text-md font-semibold">Total: &#8377;<%= order.payment.discountPrice %></p>
                                    <a href="/user/orders/<%= order._id %>" class="cursor-pointer hover:text-blue-500" >View order details</a>
                                </div>
                            </div>
    
                            <!-- Product List -->
                            <div>
                                <% order.items.forEach(item => { %>
                                    <div class="flex items-center mb-4 border-b pb-4 last:border-b-0">
                                        <!-- Product Image -->
                                        <img
                                            src="/uploads/<%= item.productId.images[0] %>"
                                            alt="<%= item.productId.name %>"
                                            class="w-20 h-20 object-contain mr-4"
                                        />
                                        <!-- Product Details -->
                                        <div class="flex-1">
                                            <h4 class="text-gray-800 font-semibold"><%= item.productId.name %></h4>
                                            <p class="text-gray-600 text-sm">Color: <%= item.productId.color %></p>
                                            <p class="text-gray-600 text-sm">Qty: <%= item.quantity %></p>
                                        </div>
                                        <!-- Price Section -->
                                        <div class="w-32 mr-32 text-center">
                                            <p class="text-gray-700 font-semibold text-lg">&#8377;<%= item.productId.discountPrice %></p>
                                        </div>
                                        <div class="w-32 mr-32 text-center">
                                            <p class="text-green-600 text-sm font-medium ml-24"><%=item.status %></p>
                                        </div>
                                        <!-- Cancel Button -->
                                        <div class="w-32 text-right">
                                            <button 
                                                onclick="cancelProduct('<%= item.productId._id %>')" 
                                                class=" border border-gray-800 px-4 py-1 rounded-md bg-gray-800 hover:bg-gray-900 text-white">
                                                Cancel
                                            </button>
                                        </div>
                                    </div>
                                <% }) %>
                            </div>
    
                        </div>
                    
                <% }) %>
                    
                <% } else { %>

                    <div class="w-full">
                        <div class="w-full h-[580px] bg-white border rounded-md shadow-md pt-48">
                            <h1 class="font-bold text-2xl text-center">You haven't placed any orders yet!</h1>
                            <p class="text-center mt-4">Explore our wide selection and find something you like</p>
                            <div class="flex justify-center pt-4">
                                <a href="/all/products">
                                    <button class="bg-gray-900 text-white px-4 py-2 rounded font-semibold hover:bg-gray-700">Explore our Products</button>
                                </a>
                            </div>
                        </div>
                    </div>
                    
                <% } %>

               
            </div>
        </div>
    </div>

    <!-- Include footer partial -->
    <%- include("partials/footer") %>
</div>

<script>
    function cancelProduct(productId) {
        // Example cancellation logic
        if (confirm("Are you sure you want to cancel this product?")) {
            fetch(`/cancel-product/${productId}`, { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert("Product canceled successfully.");
                        location.reload();
                    } else {
                        alert("Unable to cancel product. Please try again.");
                    }
                });
        }
    }
</script>
